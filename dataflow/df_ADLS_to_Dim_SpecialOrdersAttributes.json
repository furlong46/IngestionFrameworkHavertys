{
	"name": "df_ADLS_to_Dim_SpecialOrdersAttributes",
	"properties": {
		"folder": {
			"name": "Dim_DataFlows"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_ADLSG2parquet_staging_masterdata_product_tbsoadef",
						"type": "DatasetReference"
					},
					"name": "SourceTbsoadef"
				},
				{
					"dataset": {
						"referenceName": "ds_ADLSG2parquet_staging_masterdata_product_tbsoitmatr",
						"type": "DatasetReference"
					},
					"name": "SourceTbsoitmatr"
				},
				{
					"dataset": {
						"referenceName": "ds_ADLSG2parquet_staging_masterdata_product_tbsogdef",
						"type": "DatasetReference"
					},
					"name": "SourceTbsogdef"
				},
				{
					"dataset": {
						"referenceName": "ds_ADLSG2parquet_staging_masterdata_product_tbsoatyp",
						"type": "DatasetReference"
					},
					"name": "SourceTbsoatyp"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_Dim_SKU",
						"type": "DatasetReference"
					},
					"name": "SourceDimSKU"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_Dim_SpecialOrderAttributes",
						"type": "DatasetReference"
					},
					"name": "SourceSpecialOrderDim"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_Dim_SpecialOrderAttributes",
						"type": "DatasetReference"
					},
					"name": "SinkSpecialOrderAttributes"
				}
			],
			"transformations": [
				{
					"name": "JoinInnerAtrtypID"
				},
				{
					"name": "JoinGradeID"
				},
				{
					"name": "JoinAtrdefID"
				},
				{
					"name": "FilterVendorUser"
				},
				{
					"name": "PivotAttribute"
				},
				{
					"name": "SelectTbsoatyp"
				},
				{
					"name": "SelectTbsogdef"
				},
				{
					"name": "SelectTbsoadef"
				},
				{
					"name": "SelectItem"
				},
				{
					"name": "DerivedAttribute"
				},
				{
					"name": "SelectTbsoitmatr"
				},
				{
					"name": "DerivedHashPlaceholders"
				},
				{
					"name": "AlterRow"
				},
				{
					"name": "LookupDimSKU"
				},
				{
					"name": "Select1"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "SelectAtrtypID"
				},
				{
					"name": "LookupDimUpdates"
				},
				{
					"name": "SelectDim"
				},
				{
					"name": "FilterUpdates"
				},
				{
					"name": "WindowRemoveDuplicates"
				},
				{
					"name": "FilterRemoveDuplicates"
				}
			],
			"script": "\nparameters{\n\tMasterProcessNumber as string ('1')\n}\nsource(output(\n\t\tATRDEFID as decimal(38,18),\n\t\tVENDOR as string,\n\t\tUSERDESC as string,\n\t\tVENDORDESC as string,\n\t\tIMAGE as string,\n\t\tSTATUS as string,\n\t\tGRADEID as decimal(38,18),\n\t\tCREATED as timestamp,\n\t\tUPDATED as timestamp,\n\t\tSYNCHED as timestamp,\n\t\tFULLRPTIMG as string,\n\t\tFULLRPTHT as decimal(38,18),\n\t\tFULLRPTWD as decimal(38,18),\n\t\tSWATCHHT as decimal(38,18),\n\t\tSWATCHWD as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> SourceTbsoadef\nsource(output(\n\t\tITEM as string,\n\t\tGROUPID as decimal(38,18),\n\t\tPRODID as decimal(38,18),\n\t\tATRTYPID as decimal(38,18),\n\t\tGRADEID as decimal(38,18),\n\t\tATRDEFID as decimal(38,18),\n\t\tCREATED as timestamp,\n\t\tUPDATED as timestamp,\n\t\tSYNCHED as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> SourceTbsoitmatr\nsource(output(\n\t\tGRADEID as decimal(38,18),\n\t\tVENDOR as string,\n\t\tDESC as string,\n\t\tCREATED as timestamp,\n\t\tUPDATED as timestamp,\n\t\tSYNCHED as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> SourceTbsogdef\nsource(output(\n\t\tATRTYPID as decimal(38,18),\n\t\tATTRIBUTE as string,\n\t\tCREATED as timestamp,\n\t\tUPDATED as timestamp,\n\t\tSYNCHED as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> SourceTbsoatyp\nsource(output(\n\t\tSKU_sk as integer,\n\t\tSKU_Unformatted_nk as string,\n\t\tSKU as string,\n\t\tSKU_Description as string,\n\t\tVendor_Color_ID as integer,\n\t\tVendor_Color as string,\n\t\tVendor_Color_Hex_Code as string,\n\t\tVendor_Finish_ID as integer,\n\t\tVendor_Finish as string,\n\t\tConfiguration_ID as integer,\n\t\tConfiguration as string,\n\t\tDisplay_Configuration as string,\n\t\tSize_ID as integer,\n\t\tSize as string,\n\t\tOriginal_Vendor_ID as string,\n\t\tOriginal_Vendor_sk as integer,\n\t\tCollection_ID as integer,\n\t\tCollection as string,\n\t\tGroup_ID as integer,\n\t\tGroup as string,\n\t\tProduct_ID as integer,\n\t\tProduct as string,\n\t\tReporting_Class_Code as string,\n\t\tReporting_Class as string,\n\t\tSuper_Category_ID as integer,\n\t\tSuper_Category as string,\n\t\tCategory_ID as integer,\n\t\tCategory as string,\n\t\tSub_Category_ID as integer,\n\t\tSub_Category as string,\n\t\tCurrent_EDLP_Price as decimal(10,4),\n\t\tGood_Better_Best_Category as string,\n\t\tGBB_Price_Point as string,\n\t\tMotion as string,\n\t\tDining_Style as string,\n\t\tBedroom_Style as string,\n\t\tStandalone_bed as string,\n\t\tSKU_Type as string,\n\t\tStocked as string,\n\t\tType_of_SKU as string,\n\t\tVendor as string,\n\t\tVendor_fk as integer,\n\t\tFactory as string,\n\t\tFactory_fk as integer,\n\t\tSpecial_Order_Available as string,\n\t\tVendor_Lead_Time as integer,\n\t\tProduct_Lead_Time as integer,\n\t\tGroup_Active_Start as date,\n\t\tGroup_Active_End as date,\n\t\tSKU_Flow_StartDate as date,\n\t\tSKU_Flow_EndDate as date,\n\t\tStocked_at_EDC as integer,\n\t\tStocked_at_WDC as integer,\n\t\tStocked_at_FDC as integer,\n\t\tGroup_Web_Status as integer,\n\t\tSKU_Web_Status as integer,\n\t\tMerchandising_Approval as string,\n\t\tMarketing_Approval as string,\n\t\tLineup_Status as string,\n\t\tAvailable_to_Purchase as string,\n\t\tShip_Length as integer,\n\t\tShip_Width as integer,\n\t\tShip_Height as integer,\n\t\tLength as integer,\n\t\tWidth as integer,\n\t\tHeight as integer,\n\t\tWeight as decimal(5,1),\n\t\tPrep_Cubes as decimal(5,1),\n\t\tCubes as decimal(5,1),\n\t\tPrep_Flag as string,\n\t\tAssembly_Required as string,\n\t\tAssembly_Time as decimal(4,1),\n\t\tLeave_in_Box as string,\n\t\tManufacturer_ID as string,\n\t\tUPC as long,\n\t\tHTS_Number as long,\n\t\tOriginal_SKU as string,\n\t\tRepresentative_Item as string,\n\t\tGroup_Rating_Count as integer,\n\t\tProduct_Rating_Count as integer,\n\t\tGroup_Star_Rating as decimal(6,4),\n\t\tProduct_Star_Rating as decimal(6,4),\n\t\tMade_in_ID as integer,\n\t\tMade_in_City as string,\n\t\tMade_in_State as string,\n\t\tMade_in_Country as string,\n\t\tOrigin_ID as integer,\n\t\tOrigin_City as string,\n\t\tOrigin_State as string,\n\t\tOrigin_Country as string,\n\t\tCopy as string,\n\t\tWeb_Description as string,\n\t\tPrice_Tag_Description as string,\n\t\tPrimary_Common_Color as string,\n\t\tPrimary_Common_Finish as string,\n\t\tFloor_Sample_Bedding as string,\n\t\tEmployee_Bedding as string,\n\t\tAccessory_Story as string,\n\t\t{3D_Model_Required} as string,\n\t\t{3D_Model} as string,\n\t\tScene_7_Image_URL as string,\n\t\t{Havertys.com_URL} as string,\n\t\tAdvertised_Price as decimal(7,2),\n\t\tHashKey as string,\n\t\tSourceSystem_fk as integer,\n\t\tETLBatchID_Insert as integer,\n\t\tETLBatchID_Update as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> SourceDimSKU\nsource(output(\n\t\tSKU_sk as integer,\n\t\tSKU_Unformatted_nk as string,\n\t\tHashKey as string,\n\t\tETLBatchID_Insert as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT\\n[SKU_sk],\\n[SKU_Unformatted_nk],\\n[HashKey],\\n[ETLBatchID_Insert]\\nFROM\\n[DW].[Dim_SKU_SpecialOrderAttributes]',\n\tformat: 'query') ~> SourceSpecialOrderDim\nSelectTbsoitmatr, SelectTbsoatyp join(SelectTbsoitmatr@ATRTYPID == SelectTbsoatyp@ATRTYPID,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> JoinInnerAtrtypID\nSelectAtrtypID, SelectTbsogdef join(SelectAtrtypID@GRADEID == SelectTbsogdef@GRADEID,\n\tjoinType:'left',\n\tbroadcast: 'none')~> JoinGradeID\nJoinGradeID, SelectTbsoadef join(SelectAtrtypID@ATRDEFID == SelectTbsoadef@ATRDEFID,\n\tjoinType:'left',\n\tbroadcast: 'none')~> JoinAtrdefID\nSelect1 filter(notEquals(VENDORDESC, USERDESC)) ~> FilterVendorUser\nDerivedAttribute pivot(groupBy(ITEM,\n\t\tSKU_sk),\n\tpivotBy(ATTRIBUTE, ['Accent_Fabric', 'Arm_Type', 'Armcap', 'Back_and_Seat_Cushion_Core', 'Back_Cushion_Attachment', 'Back_Cushion_Style', 'Base_Type', 'Body_Fabric', 'Body_Fabric_#1', 'Body_Fabric_#2', 'Body_Fabric_#3', 'Body_Fabric_Headboard_Back', 'Border_Location', 'Bottom_Color', 'Buttons', 'Buttons_#1', 'Buttons_#2', 'Chair_Finish', 'Chair_Seat_Finish', 'Distressing', 'Door_Hardware', 'Drapery_Border', 'Drapery_Heading', 'Drapery_Length', 'Drapery_Rod_Size', 'Drawer_Hardware', 'Fabrics', 'Finish_Color', 'Frame', 'Fringe/Cord', 'Fringe/Cord_#1', 'Fringe/Cord_#2', 'Fringe/Cord_#3', 'Fringe/Cord_#4', 'Fringe/Cord_Individual', 'Joiner', 'Kidney_Pillow_-_Back', 'Kidney_Pillow_-_Front', 'Nailhead', 'Nailhead_for_Arm', 'Nailhead_Spacing', 'Picture_Frame_Fabric', 'Pillow_Fabric-497', 'Pillow_Fabric-508', 'Pillow_Fabric_(Individual)', 'Pillow_Fabric_(Pair)', 'Pillow_Fabric_#1_Individual', 'Pillow_Fabric_#1Pair', 'Pillow_Fabric_#2_Individual', 'Pillow_Fabric_#2_Pair', 'Pillow_Fabric_#3_Individual', 'Pillow_Fabric_1_-_Back_(individual)', 'Pillow_Fabric_1_-_Back_(pair)', 'Pillow_Fabric_1_-_Front_(individual)', 'Pillow_Fabric_1_-_Front_(pair)', 'Pillow_Fabric_2_-_Back_(individual)', 'Pillow_Fabric_2_-_Back_(pair)', 'Pillow_Fabric_2_-_Front_(individual)', 'Pillow_Fabric_2_-_Front_(pair)', 'Pillow_Fabric_3_-_Back_(individual)', 'Pillow_Fabric_3_-_Back_(pair)', 'Pillow_Fabric_3_-_Front_(individual)', 'Pillow_Fabric_3_-_Front_(pair)', 'Pillow_Size', 'Rod_Finial', 'Rug_Color_A', 'Rug_Color_B', 'Rug_Color_C', 'Rug_Color_D', 'Rug_Color_E', 'Rug_Design', 'Seat_Depth', 'Server_Base_Finish', 'Server_Top_Finish', 'Solarium_Pillow_(Individual)', 'Solarium_Pillow_(Pair)', 'Stool_Height', 'Sunbrella_Pillow_(Pair)', 'Sunbrella_Pillow_#1_Individual', 'Sunbrella_Pillow_#2_Individual', 'Table_Apron_Finish', 'Table_Leg_Finish', 'Table_Top_Finish', 'Top_Color', 'Upholstery', 'Welt', 'Wing_Fabric', '7pk_Rings_with_Clips']),\n\tDescription = min(DESC),\n\tcolumnNaming: '$V$N',\n\tlateral: false) ~> PivotAttribute\nSourceTbsoatyp select(mapColumn(\n\t\tATRTYPID,\n\t\tATTRIBUTE\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectTbsoatyp\nSourceTbsogdef select(mapColumn(\n\t\tGRADEID,\n\t\tVENDOR,\n\t\tDESC\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectTbsogdef\nSourceTbsoadef select(mapColumn(\n\t\tATRDEFID,\n\t\tVENDOR,\n\t\tUSERDESC,\n\t\tVENDORDESC,\n\t\tGRADEID\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectTbsoadef\nPivotAttribute select(mapColumn(\n\t\tSKU_Unformatted_nk = ITEM,\n\t\tSKU_sk,\n\t\tAccent_Fabric = Accent_FabricDescription,\n\t\tArm_Type = Arm_TypeDescription,\n\t\tArmcap = ArmcapDescription,\n\t\tBack_and_Seat_Cushion_Core = Back_and_Seat_Cushion_CoreDescription,\n\t\tBack_Cushion_Attachment = Back_Cushion_AttachmentDescription,\n\t\tBack_Cushion_Style = Back_Cushion_StyleDescription,\n\t\tBase_Type = Base_TypeDescription,\n\t\tBody_Fabric = Body_FabricDescription,\n\t\t{Body_Fabric_#1} = {Body_Fabric_#1Description},\n\t\t{Body_Fabric_#2} = {Body_Fabric_#2Description},\n\t\t{Body_Fabric_#3} = {Body_Fabric_#3Description},\n\t\tBody_Fabric_Headboard_Back = Body_Fabric_Headboard_BackDescription,\n\t\tBorder_Location = Border_LocationDescription,\n\t\tBottom_Color = Bottom_ColorDescription,\n\t\tButtons = ButtonsDescription,\n\t\t{Buttons_#1} = {Buttons_#1Description},\n\t\t{Buttons_#2} = {Buttons_#2Description},\n\t\tChair_Finish = Chair_FinishDescription,\n\t\tChair_Seat_Finish = Chair_Seat_FinishDescription,\n\t\tDistressing = DistressingDescription,\n\t\tDoor_Hardware = Door_HardwareDescription,\n\t\tDrapery_Border = Drapery_BorderDescription,\n\t\tDrapery_Heading = Drapery_HeadingDescription,\n\t\tDrapery_Length = Drapery_LengthDescription,\n\t\tDrapery_Rod_Size = Drapery_Rod_SizeDescription,\n\t\tDrawer_Hardware = Drawer_HardwareDescription,\n\t\tFabrics = FabricsDescription,\n\t\tFinish_Color = Finish_ColorDescription,\n\t\tFrame = FrameDescription,\n\t\t{Fringe/Cord} = {Fringe/CordDescription},\n\t\t{Fringe/Cord_#1} = {Fringe/Cord_#1Description},\n\t\t{Fringe/Cord_#2} = {Fringe/Cord_#2Description},\n\t\t{Fringe/Cord_#3} = {Fringe/Cord_#3Description},\n\t\t{Fringe/Cord_#4} = {Fringe/Cord_#4Description},\n\t\t{Fringe/Cord_Individual} = {Fringe/Cord_IndividualDescription},\n\t\tJoiner = JoinerDescription,\n\t\t{Kidney_Pillow_-_Back} = {Kidney_Pillow_-_BackDescription},\n\t\t{Kidney_Pillow_-_Front} = {Kidney_Pillow_-_FrontDescription},\n\t\tNailhead = NailheadDescription,\n\t\tNailhead_for_Arm = Nailhead_for_ArmDescription,\n\t\tNailhead_Spacing = Nailhead_SpacingDescription,\n\t\tPicture_Frame_Fabric = Picture_Frame_FabricDescription,\n\t\t{Pillow_Fabric-497} = {Pillow_Fabric-497Description},\n\t\t{Pillow_Fabric-508} = {Pillow_Fabric-508Description},\n\t\t{Pillow_Fabric_(Individual)} = {Pillow_Fabric_(Individual)Description},\n\t\t{Pillow_Fabric_(Pair)} = {Pillow_Fabric_(Pair)Description},\n\t\t{Pillow_Fabric_#1_Individual} = {Pillow_Fabric_#1_IndividualDescription},\n\t\t{Pillow_Fabric_#1Pair} = {Pillow_Fabric_#1PairDescription},\n\t\t{Pillow_Fabric_#2_Individual} = {Pillow_Fabric_#2_IndividualDescription},\n\t\t{Pillow_Fabric_#2_Pair} = {Pillow_Fabric_#2_PairDescription},\n\t\t{Pillow_Fabric_#3_Individual} = {Pillow_Fabric_#3_IndividualDescription},\n\t\t{Pillow_Fabric_1_-_Back_(individual)} = {Pillow_Fabric_1_-_Back_(individual)Description},\n\t\t{Pillow_Fabric_1_-_Back_(pair)} = {Pillow_Fabric_1_-_Back_(pair)Description},\n\t\t{Pillow_Fabric_1_-_Front_(individual)} = {Pillow_Fabric_1_-_Front_(individual)Description},\n\t\t{Pillow_Fabric_1_-_Front_(pair)} = {Pillow_Fabric_1_-_Front_(pair)Description},\n\t\t{Pillow_Fabric_2_-_Back_(individual)} = {Pillow_Fabric_2_-_Back_(individual)Description},\n\t\t{Pillow_Fabric_2_-_Back_(pair)} = {Pillow_Fabric_2_-_Back_(pair)Description},\n\t\t{Pillow_Fabric_2_-_Front_(individual)} = {Pillow_Fabric_2_-_Front_(individual)Description},\n\t\t{Pillow_Fabric_2_-_Front_(pair)} = {Pillow_Fabric_2_-_Front_(pair)Description},\n\t\t{Pillow_Fabric_3_-_Back_(individual)} = {Pillow_Fabric_3_-_Back_(individual)Description},\n\t\t{Pillow_Fabric_3_-_Back_(pair)} = {Pillow_Fabric_3_-_Back_(pair)Description},\n\t\t{Pillow_Fabric_3_-_Front_(individual)} = {Pillow_Fabric_3_-_Front_(individual)Description},\n\t\t{Pillow_Fabric_3_-_Front_(pair)} = {Pillow_Fabric_3_-_Front_(pair)Description},\n\t\tPillow_Size = Pillow_SizeDescription,\n\t\tRod_Finial = Rod_FinialDescription,\n\t\tRug_Color_A = Rug_Color_ADescription,\n\t\tRug_Color_B = Rug_Color_BDescription,\n\t\tRug_Color_C = Rug_Color_CDescription,\n\t\tRug_Color_D = Rug_Color_DDescription,\n\t\tRug_Color_E = Rug_Color_EDescription,\n\t\tRug_Design = Rug_DesignDescription,\n\t\tSeat_Depth = Seat_DepthDescription,\n\t\tServer_Base_Finish = Server_Base_FinishDescription,\n\t\tServer_Top_Finish = Server_Top_FinishDescription,\n\t\t{Solarium_Pillow_(Individual)} = {Solarium_Pillow_(Individual)Description},\n\t\t{Solarium_Pillow_(Pair)} = {Solarium_Pillow_(Pair)Description},\n\t\tStool_Height = Stool_HeightDescription,\n\t\t{Sunbrella_Pillow_(Pair)} = {Sunbrella_Pillow_(Pair)Description},\n\t\t{Sunbrella_Pillow_#1_Individual} = {Sunbrella_Pillow_#1_IndividualDescription},\n\t\t{Sunbrella_Pillow_#2_Individual} = {Sunbrella_Pillow_#2_IndividualDescription},\n\t\tTable_Apron_Finish = Table_Apron_FinishDescription,\n\t\tTable_Leg_Finish = Table_Leg_FinishDescription,\n\t\tTable_Top_Finish = Table_Top_FinishDescription,\n\t\tTop_Color = Top_ColorDescription,\n\t\tUpholstery = UpholsteryDescription,\n\t\tWelt = WeltDescription,\n\t\tWing_Fabric = Wing_FabricDescription,\n\t\t{7pk_Rings_with_Clips} = {7pk_Rings_with_ClipsDescription}\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectItem\nFilterVendorUser derive(ATTRIBUTE = replace(trim(ATTRIBUTE), ' ', '_')) ~> DerivedAttribute\nSourceTbsoitmatr select(mapColumn(\n\t\tITEM,\n\t\tGROUPID,\n\t\tPRODID,\n\t\tATRTYPID,\n\t\tGRADEID,\n\t\tATRDEFID\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectTbsoitmatr\nSelectDim derive(HashKey = sha1(SKU_sk,Accent_Fabric,Arm_Type,Armcap,Back_and_Seat_Cushion_Core,Back_Cushion_Attachment,Back_Cushion_Style,Base_Type,Body_Fabric,{Body_Fabric_#1},{Body_Fabric_#2},{Body_Fabric_#3},Body_Fabric_Headboard_Back,Border_Location,Bottom_Color,Buttons,{Buttons_#1},{Buttons_#2},Chair_Finish,Chair_Seat_Finish,Distressing,Door_Hardware,Drapery_Border,Drapery_Heading,Drapery_Length,Drapery_Rod_Size,Drawer_Hardware,Fabrics,Finish_Color,Frame,{Fringe/Cord},{Fringe/Cord_#1},{Fringe/Cord_#2},{Fringe/Cord_#3},{Fringe/Cord_#4},{Fringe/Cord_Individual},Joiner,{Kidney_Pillow_-_Back},{Kidney_Pillow_-_Front},Nailhead,Nailhead_for_Arm,Nailhead_Spacing,Picture_Frame_Fabric,{Pillow_Fabric-497},{Pillow_Fabric-508},{Pillow_Fabric_(Individual)},{Pillow_Fabric_(Pair)},{Pillow_Fabric_#1_Individual},{Pillow_Fabric_#1Pair},{Pillow_Fabric_#2_Individual},{Pillow_Fabric_#2_Pair},{Pillow_Fabric_#3_Individual},{Pillow_Fabric_1_-_Back_(individual)},{Pillow_Fabric_1_-_Back_(pair)},{Pillow_Fabric_1_-_Front_(individual)},{Pillow_Fabric_1_-_Front_(pair)},{Pillow_Fabric_2_-_Back_(individual)},{Pillow_Fabric_2_-_Back_(pair)},{Pillow_Fabric_2_-_Front_(individual)},{Pillow_Fabric_2_-_Front_(pair)},{Pillow_Fabric_3_-_Back_(individual)},{Pillow_Fabric_3_-_Back_(pair)},{Pillow_Fabric_3_-_Front_(individual)},{Pillow_Fabric_3_-_Back_(pair)},{Pillow_Fabric_3_-_Front_(individual)},{Pillow_Fabric_3_-_Front_(pair)},Pillow_Size,Rod_Finial,Rug_Color_A,Rug_Color_B,Rug_Color_C,Rug_Color_D,Rug_Color_E,Rug_Design,Seat_Depth,Server_Base_Finish,Server_Top_Finish,{Solarium_Pillow_(Individual)},{Solarium_Pillow_(Pair)},Stool_Height,{Sunbrella_Pillow_(Pair)},{Sunbrella_Pillow_#1_Individual},{Sunbrella_Pillow_#2_Individual},Table_Apron_Finish,Table_Leg_Finish,Table_Top_Finish,Top_Color,Upholstery,Welt,Wing_Fabric,{7pk_Rings_with_Clips}),\n\t\tETLBatchID_Insert = iifNull(ETLBatchID_InsertDim, toInteger($MasterProcessNumber)),\n\t\tETLBatchID_Update = toInteger($MasterProcessNumber),\n\t\tSourceSystem_fk = 0,\n\t\teach(match(type=='string'), $$ = iif(isNull($$),'', trim($$))),\n\t\teach(match(type=='integer'), $$ = iif(isNull($$),0, $$))) ~> DerivedHashPlaceholders\nFilterUpdates alterRow(insertIf(isNull(SKU_Unformatted_nkDim)),\n\tupdateIf(!isNull(SKU_Unformatted_nkDim)&&HashKey!=HashKeyDim)) ~> AlterRow\nJoinAtrdefID, SourceDimSKU lookup(ITEM == SKU_Unformatted_nk,\n\tbroadcast: 'none')~> LookupDimSKU\nDerivedColumn1 select(mapColumn(\n\t\tITEM,\n\t\tATTRIBUTE,\n\t\tDESC,\n\t\tUSERDESC,\n\t\tVENDORDESC,\n\t\tSKU_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Select1\nLookupDimSKU derive(ATTRIBUTE = case(ATTRIBUTE == 'Pillow Fabric', concat(ATTRIBUTE, toString(ATRTYPID)), ATTRIBUTE)) ~> DerivedColumn1\nJoinInnerAtrtypID select(mapColumn(\n\t\tITEM,\n\t\tGROUPID,\n\t\tPRODID,\n\t\tATRTYPID = SelectTbsoitmatr@ATRTYPID,\n\t\tGRADEID,\n\t\tATRDEFID,\n\t\tATTRIBUTE\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectAtrtypID\nSelectItem, SourceSpecialOrderDim lookup(SelectItem@SKU_Unformatted_nk == SourceSpecialOrderDim@SKU_Unformatted_nk,\n\tbroadcast: 'none')~> LookupDimUpdates\nLookupDimUpdates select(mapColumn(\n\t\tSKU_Unformatted_nk = SelectItem@SKU_Unformatted_nk,\n\t\tSKU_sk = SelectItem@SKU_sk,\n\t\tAccent_Fabric,\n\t\tArm_Type,\n\t\tArmcap,\n\t\tBack_and_Seat_Cushion_Core,\n\t\tBack_Cushion_Attachment,\n\t\tBack_Cushion_Style,\n\t\tBase_Type,\n\t\tBody_Fabric,\n\t\t{Body_Fabric_#1},\n\t\t{Body_Fabric_#2},\n\t\t{Body_Fabric_#3},\n\t\tBody_Fabric_Headboard_Back,\n\t\tBorder_Location,\n\t\tBottom_Color,\n\t\tButtons,\n\t\t{Buttons_#1},\n\t\t{Buttons_#2},\n\t\tChair_Finish,\n\t\tChair_Seat_Finish,\n\t\tDistressing,\n\t\tDoor_Hardware,\n\t\tDrapery_Border,\n\t\tDrapery_Heading,\n\t\tDrapery_Length,\n\t\tDrapery_Rod_Size,\n\t\tDrawer_Hardware,\n\t\tFabrics,\n\t\tFinish_Color,\n\t\tFrame,\n\t\t{Fringe/Cord},\n\t\t{Fringe/Cord_#1},\n\t\t{Fringe/Cord_#2},\n\t\t{Fringe/Cord_#3},\n\t\t{Fringe/Cord_#4},\n\t\t{Fringe/Cord_Individual},\n\t\tJoiner,\n\t\t{Kidney_Pillow_-_Back},\n\t\t{Kidney_Pillow_-_Front},\n\t\tNailhead,\n\t\tNailhead_for_Arm,\n\t\tNailhead_Spacing,\n\t\tPicture_Frame_Fabric,\n\t\t{Pillow_Fabric-497},\n\t\t{Pillow_Fabric-508},\n\t\t{Pillow_Fabric_(Individual)},\n\t\t{Pillow_Fabric_(Pair)},\n\t\t{Pillow_Fabric_#1_Individual},\n\t\t{Pillow_Fabric_#1Pair},\n\t\t{Pillow_Fabric_#2_Individual},\n\t\t{Pillow_Fabric_#2_Pair},\n\t\t{Pillow_Fabric_#3_Individual},\n\t\t{Pillow_Fabric_1_-_Back_(individual)},\n\t\t{Pillow_Fabric_1_-_Back_(pair)},\n\t\t{Pillow_Fabric_1_-_Front_(individual)},\n\t\t{Pillow_Fabric_1_-_Front_(pair)},\n\t\t{Pillow_Fabric_2_-_Back_(individual)} = {Pillow_Fabric_#2_Individual},\n\t\t{Pillow_Fabric_2_-_Back_(pair)},\n\t\t{Pillow_Fabric_2_-_Front_(individual)},\n\t\t{Pillow_Fabric_2_-_Front_(pair)},\n\t\t{Pillow_Fabric_3_-_Back_(individual)},\n\t\t{Pillow_Fabric_3_-_Back_(pair)},\n\t\t{Pillow_Fabric_3_-_Front_(individual)},\n\t\t{Pillow_Fabric_3_-_Front_(pair)},\n\t\tPillow_Size,\n\t\tRod_Finial,\n\t\tRug_Color_A,\n\t\tRug_Color_B,\n\t\tRug_Color_C,\n\t\tRug_Color_D,\n\t\tRug_Color_E,\n\t\tRug_Design,\n\t\tSeat_Depth,\n\t\tServer_Base_Finish,\n\t\tServer_Top_Finish,\n\t\t{Solarium_Pillow_(Individual)},\n\t\t{Solarium_Pillow_(Pair)},\n\t\tStool_Height,\n\t\t{Sunbrella_Pillow_(Pair)},\n\t\t{Sunbrella_Pillow_#1_Individual},\n\t\t{Sunbrella_Pillow_#2_Individual},\n\t\tTable_Apron_Finish,\n\t\tTable_Leg_Finish,\n\t\tTable_Top_Finish,\n\t\tTop_Color,\n\t\tUpholstery,\n\t\tWelt,\n\t\tWing_Fabric,\n\t\t{7pk_Rings_with_Clips},\n\t\tSKU_Unformatted_nkDim = SourceSpecialOrderDim@SKU_Unformatted_nk,\n\t\tHashKeyDim = HashKey,\n\t\tETLBatchID_InsertDim = ETLBatchID_Insert\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDim\nFilterRemoveDuplicates filter(isNull(SKU_Unformatted_nkDim)||!isNull(SKU_Unformatted_nkDim)&&HashKey!=HashKeyDim) ~> FilterUpdates\nDerivedHashPlaceholders window(over(SKU_Unformatted_nk),\n\tasc(SKU_Unformatted_nk, true),\n\tDupeCount = rowNumber()) ~> WindowRemoveDuplicates\nWindowRemoveDuplicates filter(DupeCount==1) ~> FilterRemoveDuplicates\nAlterRow sink(input(\n\t\tSKU_sk as integer,\n\t\tSKU_Unformatted_nk as string,\n\t\tAccent_Fabric as string,\n\t\tArm_Type as string,\n\t\tArmcap as string,\n\t\tBack_and_Seat_Cushion_Core as string,\n\t\tBack_Cushion_Attachment as string,\n\t\tBack_Cushion_Style as string,\n\t\tBase_Type as string,\n\t\tBody_Fabric as string,\n\t\t{Body_Fabric_#1} as string,\n\t\t{Body_Fabric_#2} as string,\n\t\t{Body_Fabric_#3} as string,\n\t\tBody_Fabric_Headboard_Back as string,\n\t\tBorder_Location as string,\n\t\tBottom_Color as string,\n\t\tButtons as string,\n\t\t{Buttons_#1} as string,\n\t\t{Buttons_#2} as string,\n\t\tChair_Finish as string,\n\t\tChair_Seat_Finish as string,\n\t\tDistressing as string,\n\t\tDoor_Hardware as string,\n\t\tDrapery_Border as string,\n\t\tDrapery_Heading as string,\n\t\tDrapery_Length as string,\n\t\tDrapery_Rod_Size as string,\n\t\tDrawer_Hardware as string,\n\t\tFabrics as string,\n\t\tFinish_Color as string,\n\t\tFrame as string,\n\t\t{Fringe/Cord} as string,\n\t\t{Fringe/Cord_#1} as string,\n\t\t{Fringe/Cord_#2} as string,\n\t\t{Fringe/Cord_#3} as string,\n\t\t{Fringe/Cord_#4} as string,\n\t\t{Fringe/Cord_Individual} as string,\n\t\tJoiner as string,\n\t\t{Kidney_Pillow_-_Back} as string,\n\t\t{Kidney_Pillow_-_Front} as string,\n\t\tNailhead as string,\n\t\tNailhead_for_Arm as string,\n\t\tNailhead_Spacing as string,\n\t\tPicture_Frame_Fabric as string,\n\t\t{Pillow_Fabric-497} as string,\n\t\t{Pillow_Fabric-508} as string,\n\t\t{Pillow_Fabric_(Individual)} as string,\n\t\t{Pillow_Fabric_(Pair)} as string,\n\t\t{Pillow_Fabric_#1_Individual} as string,\n\t\t{Pillow_Fabric_#1Pair} as string,\n\t\t{Pillow_Fabric_#2_Individual} as string,\n\t\t{Pillow_Fabric_#2_Pair} as string,\n\t\t{Pillow_Fabric_#3_Individual} as string,\n\t\t{Pillow_Fabric_1_-_Back_(individual)} as string,\n\t\t{Pillow_Fabric_1_-_Back_(pair)} as string,\n\t\t{Pillow_Fabric_1_-_Front_(individual)} as string,\n\t\t{Pillow_Fabric_1_-_Front_(pair)} as string,\n\t\t{Pillow_Fabric_2_-_Back_(individual)} as string,\n\t\t{Pillow_Fabric_2_-_Back_(pair)} as string,\n\t\t{Pillow_Fabric_2_-_Front_(individual)} as string,\n\t\t{Pillow_Fabric_2_-_Front_(pair)} as string,\n\t\t{Pillow_Fabric_3_-_Back_(individual)} as string,\n\t\t{Pillow_Fabric_3_-_Back_(pair)} as string,\n\t\t{Pillow_Fabric_3_-_Front_(individual)} as string,\n\t\t{Pillow_Fabric_3_-_Front_(pair)} as string,\n\t\tPillow_Size as string,\n\t\tRod_Finial as string,\n\t\tRug_Color_A as string,\n\t\tRug_Color_B as string,\n\t\tRug_Color_C as string,\n\t\tRug_Color_D as string,\n\t\tRug_Color_E as string,\n\t\tRug_Design as string,\n\t\tSeat_Depth as string,\n\t\tServer_Base_Finish as string,\n\t\tServer_Top_Finish as string,\n\t\t{Solarium_Pillow_(Individual)} as string,\n\t\t{Solarium_Pillow_(Pair)} as string,\n\t\tStool_Height as string,\n\t\t{Sunbrella_Pillow_(Pair)} as string,\n\t\t{Sunbrella_Pillow_#1_Individual} as string,\n\t\t{Sunbrella_Pillow_#2_Individual} as string,\n\t\tTable_Apron_Finish as string,\n\t\tTable_Leg_Finish as string,\n\t\tTable_Top_Finish as string,\n\t\tTop_Color as string,\n\t\tUpholstery as string,\n\t\tWelt as string,\n\t\tWing_Fabric as string,\n\t\t{7pk_Rings_with_Clips} as string,\n\t\tHashKey as string,\n\t\tSourceSystem_fk as integer,\n\t\tETLBatchID_Insert as integer,\n\t\tETLBatchID_Update as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['SKU_Unformatted_nk'],\n\tformat: 'table',\n\tmapColumn(\n\t\tSKU_sk,\n\t\tSKU_Unformatted_nk,\n\t\tAccent_Fabric,\n\t\tArm_Type,\n\t\tArmcap,\n\t\tBack_and_Seat_Cushion_Core,\n\t\tBack_Cushion_Attachment,\n\t\tBack_Cushion_Style,\n\t\tBase_Type,\n\t\tBody_Fabric,\n\t\t{Body_Fabric_#1},\n\t\t{Body_Fabric_#2},\n\t\t{Body_Fabric_#3},\n\t\tBody_Fabric_Headboard_Back,\n\t\tBorder_Location,\n\t\tBottom_Color,\n\t\tButtons,\n\t\t{Buttons_#1},\n\t\t{Buttons_#2},\n\t\tChair_Finish,\n\t\tChair_Seat_Finish,\n\t\tDistressing,\n\t\tDoor_Hardware,\n\t\tDrapery_Border,\n\t\tDrapery_Heading,\n\t\tDrapery_Length,\n\t\tDrapery_Rod_Size,\n\t\tDrawer_Hardware,\n\t\tFabrics,\n\t\tFinish_Color,\n\t\tFrame,\n\t\t{Fringe/Cord},\n\t\t{Fringe/Cord_#1},\n\t\t{Fringe/Cord_#2},\n\t\t{Fringe/Cord_#3},\n\t\t{Fringe/Cord_#4},\n\t\t{Fringe/Cord_Individual},\n\t\tJoiner,\n\t\t{Kidney_Pillow_-_Back},\n\t\t{Kidney_Pillow_-_Front},\n\t\tNailhead,\n\t\tNailhead_for_Arm,\n\t\tNailhead_Spacing,\n\t\tPicture_Frame_Fabric,\n\t\t{Pillow_Fabric-497},\n\t\t{Pillow_Fabric-508},\n\t\t{Pillow_Fabric_(Individual)},\n\t\t{Pillow_Fabric_(Pair)},\n\t\t{Pillow_Fabric_#1_Individual},\n\t\t{Pillow_Fabric_#1Pair},\n\t\t{Pillow_Fabric_#2_Individual},\n\t\t{Pillow_Fabric_#2_Pair},\n\t\t{Pillow_Fabric_#3_Individual},\n\t\t{Pillow_Fabric_1_-_Back_(individual)},\n\t\t{Pillow_Fabric_1_-_Back_(pair)},\n\t\t{Pillow_Fabric_1_-_Front_(individual)},\n\t\t{Pillow_Fabric_1_-_Front_(pair)},\n\t\t{Pillow_Fabric_2_-_Back_(individual)},\n\t\t{Pillow_Fabric_2_-_Back_(pair)},\n\t\t{Pillow_Fabric_2_-_Front_(individual)},\n\t\t{Pillow_Fabric_2_-_Front_(pair)},\n\t\t{Pillow_Fabric_3_-_Back_(individual)},\n\t\t{Pillow_Fabric_3_-_Back_(pair)},\n\t\t{Pillow_Fabric_3_-_Front_(individual)},\n\t\t{Pillow_Fabric_3_-_Front_(pair)},\n\t\tPillow_Size,\n\t\tRod_Finial,\n\t\tRug_Color_A,\n\t\tRug_Color_B,\n\t\tRug_Color_C,\n\t\tRug_Color_D,\n\t\tRug_Color_E,\n\t\tRug_Design,\n\t\tSeat_Depth,\n\t\tServer_Base_Finish,\n\t\tServer_Top_Finish,\n\t\t{Solarium_Pillow_(Individual)},\n\t\t{Solarium_Pillow_(Pair)},\n\t\tStool_Height,\n\t\t{Sunbrella_Pillow_(Pair)},\n\t\t{Sunbrella_Pillow_#1_Individual},\n\t\t{Sunbrella_Pillow_#2_Individual},\n\t\tTable_Apron_Finish,\n\t\tTable_Leg_Finish,\n\t\tTable_Top_Finish,\n\t\tTop_Color,\n\t\tUpholstery,\n\t\tWelt,\n\t\tWing_Fabric,\n\t\t{7pk_Rings_with_Clips},\n\t\tHashKey,\n\t\tSourceSystem_fk,\n\t\tETLBatchID_Insert,\n\t\tETLBatchID_Update\n\t)) ~> SinkSpecialOrderAttributes"
		}
	}
}