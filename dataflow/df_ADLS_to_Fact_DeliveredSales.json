{
	"name": "df_ADLS_to_Fact_DeliveredSales",
	"properties": {
		"folder": {
			"name": "Fact_DataFlows"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_ADLSG2Parquet_stagin_sales_tbdwblddel",
						"type": "DatasetReference"
					},
					"name": "SourceTbdwbld"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_DW_DimDate",
						"type": "DatasetReference"
					},
					"name": "sourceDimDate"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_DW_DimTime",
						"type": "DatasetReference"
					},
					"name": "sourceDimTime"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_Dim_SKU",
						"type": "DatasetReference"
					},
					"name": "sourceDimSKU"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_HavertysDW_DimCustomer",
						"type": "DatasetReference"
					},
					"name": "sourceDimCustomer"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_HavertysDW_Dim_Team",
						"type": "DatasetReference"
					},
					"name": "sourceDimTeam"
				},
				{
					"dataset": {
						"referenceName": "ds_ADLSG2_staging_masterdata_employee_tbdwemp",
						"type": "DatasetReference"
					},
					"name": "sourceTbdwemp"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_HavertysDW_DimOverrideReason",
						"type": "DatasetReference"
					},
					"name": "sourceDimOverrideReason"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_DW_DimLocation",
						"type": "DatasetReference"
					},
					"name": "sourceDimLocation"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_DW_Dim_CreditPromotion",
						"type": "DatasetReference"
					},
					"name": "sourceDimCreditPromotion"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSqlTable_Dim_MerchandisingPromotion",
						"type": "DatasetReference"
					},
					"name": "sourceMerchandisingPromotion"
				},
				{
					"dataset": {
						"referenceName": "ds_AzureSQLTable_HavertysDW_Fact_DeliveredSales",
						"type": "DatasetReference"
					},
					"name": "sourceFactDeliveredSales"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_AzureSQLTable_HavertysDW_Fact_DeliveredSales",
						"type": "DatasetReference"
					},
					"name": "sinkFactDeliveredSales"
				}
			],
			"transformations": [
				{
					"name": "AlwaysInsertDeleteInSinkPreSQL"
				},
				{
					"name": "DeriveCalculatedColumns"
				},
				{
					"name": "LookupDimDate"
				},
				{
					"name": "LookupDimSKU"
				},
				{
					"name": "LookupDimSKUGroup"
				},
				{
					"name": "LookupDimCustomer"
				},
				{
					"name": "Derivetbdwemp",
					"description": "Autogenerated by data preview actions"
				},
				{
					"name": "DeriveDesignerTeamLookups"
				},
				{
					"name": "SelectDimDate"
				},
				{
					"name": "LookupSalesEmpNum"
				},
				{
					"name": "SelectSalesEmpNum"
				},
				{
					"name": "LookupCoSalesEmpNum"
				},
				{
					"name": "SelectCoSalesEmpNum"
				},
				{
					"name": "DeriveSalesEmployee"
				},
				{
					"name": "DeriveSalesTeamLookups"
				},
				{
					"name": "DeriveTrimNullsStrings"
				},
				{
					"name": "SelectTbdwemp"
				},
				{
					"name": "LookupDimTeamDesigner"
				},
				{
					"name": "SelectDimTeamDesigner"
				},
				{
					"name": "LookupDimTeamSales"
				},
				{
					"name": "SelectDimTeamSales"
				},
				{
					"name": "SelectDimSKU"
				},
				{
					"name": "SelectDimSKUGroup"
				},
				{
					"name": "SelectDimCustomer"
				},
				{
					"name": "LookupDimLocation"
				},
				{
					"name": "DeriveLocationCode"
				},
				{
					"name": "SelectDimLocation"
				},
				{
					"name": "LookupDimCreditPromo"
				},
				{
					"name": "SelectDimCreditPromo"
				},
				{
					"name": "LookupDimMerchandisingPromo"
				},
				{
					"name": "SelectDimMerchandisingPromo"
				},
				{
					"name": "LookupDimOverrideReason"
				},
				{
					"name": "SelectDimOverrideReasonPlusRenames"
				},
				{
					"name": "LookupDimDeliveryDC"
				},
				{
					"name": "SelectDimDeliveryDC"
				},
				{
					"name": "LookupFactDeliveredSalesExists"
				},
				{
					"name": "SelectFactDeliveredSalesExists"
				},
				{
					"name": "FilterNewAndUpdates"
				},
				{
					"name": "DeriveETLBatchIDInsert"
				},
				{
					"name": "LookupDeliveredDate"
				},
				{
					"name": "SelectDimDelieveredDate"
				},
				{
					"name": "WindowRowNumber"
				},
				{
					"name": "FilterDuplicates"
				},
				{
					"name": "WindowRowNumber1"
				},
				{
					"name": "FilterRowNumber1"
				}
			],
			"script": "parameters{\n\tControlStartDate as string ('20100701'),\n\tControlEndDate as string ('20190718')\n}\nsource(output(\n\t\tPROCESS_NUMBER as decimal(38,18),\n\t\tDIVISION as decimal(38,18),\n\t\tMARKET as decimal(38,18),\n\t\tBRANCH as decimal(38,18),\n\t\tSALENUM as decimal(38,18),\n\t\tLINE as decimal(38,18),\n\t\tTYPE as string,\n\t\tTRANTYPE as string,\n\t\tTRANSEQUENCE as decimal(38,18),\n\t\tORGSALENUM as decimal(38,18),\n\t\tBILLEDDATE as timestamp,\n\t\tWRITTENDATE as timestamp,\n\t\tITEM as string,\n\t\tGROUPSKU as string,\n\t\tQUANTITY as decimal(38,18),\n\t\tGROSSSLS as decimal(38,18),\n\t\tGRPSKUDSCT as decimal(38,18),\n\t\tRTLREDUCTION as decimal(38,18),\n\t\tOVRDISCOUNT as decimal(38,18),\n\t\tPROMODISCOUNT as decimal(38,18),\n\t\tUNCLASSDSCT as decimal(38,18),\n\t\tUNDLVALLOW as decimal(38,18),\n\t\tRETAIL as decimal(38,18),\n\t\tTAXAMT1 as decimal(38,18),\n\t\tTAXAMT2 as decimal(38,18),\n\t\tCIDNUM as decimal(38,18),\n\t\tCIDPRFSEQ as decimal(38,18),\n\t\tSALEASC as decimal(38,18),\n\t\tSALEEMPID as decimal(38,18),\n\t\tCOSALEASC as decimal(38,18),\n\t\tCOSALEEMPID as decimal(38,18),\n\t\tDESIGNER as decimal(38,18),\n\t\tCODESIGNER as decimal(38,18),\n\t\tOVRRSNID as decimal(38,18),\n\t\tOVRRSNDESC as string,\n\t\tOVRRSNCMT as string,\n\t\tOVRUSRFNAM as string,\n\t\tOVRUSRLNAM as string,\n\t\tSALEPROMO as string,\n\t\tCREDITPROMO as string,\n\t\tDELIVERYDC as decimal(38,18),\n\t\tLANDEDCOST as decimal(38,18),\n\t\tCHARGETYPE as string,\n\t\tINTERNETSALE as string,\n\t\tEXCHANGETYPE as string,\n\t\tGROUPLINE as decimal(38,18),\n\t\tITEMSINGROUP as decimal(38,18),\n\t\tOMNICHANNEL as string,\n\t\tDELIVERYTYPE as string,\n\t\tORIGINATION as string,\n\t\tBOLPIS as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> SourceTbdwbld\nsource(output(\n\t\tDate_sk as integer,\n\t\tCalendar_date as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_COMMITTED',\n\tquery: 'SELECT [Date_sk]\\n   \\n      ,[Calendar_date]\\n \\n  FROM [DW].[Dim_Date]',\n\tformat: 'query') ~> sourceDimDate\nsource(output(\n\t\tTime_sk as integer,\n\t\tTime24_name as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_COMMITTED',\n\tquery: 'SELECT  [Time_sk]\\n      ,[Time24_name]\\n    \\n  FROM [DW].[Dim_Time]',\n\tformat: 'query') ~> sourceDimTime\nsource(output(\n\t\tSKU_sk as integer,\n\t\tSKU_Unformatted_nk as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_COMMITTED',\n\tquery: 'SELECT [SKU_sk]\\n      ,[SKU_Unformatted_nk]\\n \\n  FROM [DW].[Dim_SKU]',\n\tformat: 'query') ~> sourceDimSKU\nsource(output(\n\t\tCustomer_sk as integer,\n\t\tCustomer_Sequence_nk as integer,\n\t\tCustomer_ID_nk as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_COMMITTED',\n\tquery: 'SELECT  [Customer_sk]\\n      ,[Customer_Sequence_nk]\\n      ,[Customer_ID_nk]\\n   \\n  FROM [DW].[Dim_Customer]',\n\tformat: 'query') ~> sourceDimCustomer\nsource(output(\n\t\tTeam_sk as integer,\n\t\tTeamMember1_ID_nk as integer,\n\t\tTeamMember2_ID_nk as integer,\n\t\tTeamType_nk as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_COMMITTED',\n\tquery: 'SELECT  [Team_sk]\\n      ,[TeamMember1_ID_nk]\\n      ,[TeamMember2_ID_nk]\\n\t  ,[TeamType_nk]\\n  FROM [DW].[Dim_Team]',\n\tformat: 'query') ~> sourceDimTeam\nsource(output(\n\t\tEMPLOYEE_NUMBER_TYPE as string,\n\t\tEMPLOYEE_NUMBER as string,\n\t\tFIRST_NAME as string,\n\t\tLAST_NAME as string,\n\t\tDIVISION as decimal(38,18),\n\t\tCENTER as decimal(38,18),\n\t\tBRANCH as decimal(38,18),\n\t\tSALES_NUMBER as decimal(38,18),\n\t\tWMS_NUMBER as decimal(38,18),\n\t\tDRIVER_NUMBER as decimal(38,18),\n\t\tDESIGNER_NUMBER as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> sourceTbdwemp\nsource(output(\n\t\tOverride_Reason_sk as integer,\n\t\tOverride_Reason_ID as integer,\n\t\tOverride_Reason as string,\n\t\tOverride_Reason_Text as string,\n\t\tOverride_Approve_First_Name as string,\n\t\tOverride_Approve_Last_Name as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT\\n[Override_Reason_sk], [Override_Reason_ID], [Override_Reason], [Override_Reason_Text], [Override_Approve_First_Name], [Override_Approve_Last_Name]\\nFROM\\n[DW].[Dim_OverrideReason]',\n\tformat: 'query') ~> sourceDimOverrideReason\nsource(output(\n\t\tLocation_sk as integer,\n\t\tLocation_Code_nk as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT\\n[Location_sk],\\n[Location_Code_nk]\\nFROM\\n[DW].[Dim_Location]',\n\tformat: 'query') ~> sourceDimLocation\nsource(output(\n\t\tCredit_Promotion_sk as integer,\n\t\tCredit_Promotion_Code_nk as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT\\nCredit_Promotion_sk,\\nUPPER(Credit_Promotion_Code_nk) AS Credit_Promotion_Code_nk\\nFROM\\n[DW].[Dim_CreditPromotion]',\n\tformat: 'query') ~> sourceDimCreditPromotion\nsource(output(\n\t\tMerchandising_Promotion_sk as integer,\n\t\tMerchandising_Promotion_Key_nk as integer,\n\t\tMerchandising_Promotion_Code_nk as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT \\n[Merchandising_Promotion_sk],\\n[Merchandising_Promotion_Key_nk],\\nUPPER([Merchandising_Promotion_Code_nk]) AS [Merchandising_Promotion_Code_nk]\\nFROM\\n[DW].[Dim_MerchandisingPromotion]',\n\tformat: 'query') ~> sourceMerchandisingPromotion\nsource(output(\n\t\tDelivered_Sales_sk as integer,\n\t\tTransaction_Number_nk as integer,\n\t\tTransaction_Line_Number_nk as integer,\n\t\tMarket_nk as integer,\n\t\tSale_Type_nk as string,\n\t\tTransaction_Type_nk as string,\n\t\tTransaction_Sequence_nk as integer,\n\t\tETLBatchID_Insert as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT\\nDelivered_Sales_sk,\\nTransaction_Number_nk,\\nTransaction_Line_Number_nk,\\nMarket_nk,\\nSale_Type_nk,\\nTransaction_Type_nk,\\nTransaction_Sequence_nk,\\nETLBatchID_Insert\\nFROM\\n[Sales].[Fact_DeliveredSales]',\n\tformat: 'query') ~> sourceFactDeliveredSales\nFilterNewAndUpdates alterRow(insertIf(isNull(Delivered_Sales_sk_Dest)),\n\tupdateIf((!isNull(Delivered_Sales_sk_Dest)&&Written_Date_fk>toInteger($ControlEndDate)||Written_Date_fk<toInteger($ControlStartDate)))) ~> AlwaysInsertDeleteInSinkPreSQL\nSelectDimOverrideReasonPlusRenames derive(SourceSystem_fk = 0,\n\t\tSales_Units_GroupSKU = iifNull(Sales_Units_GroupSKU, Sales_Units),\n\t\tETLBatchID_Update = PROCESS_NUMBER,\n\t\tTotal_Discount = Gross_Sales - Retail_Sales,\n\t\tSales_Status = case(Sale_Type_nk == 'S' && Transaction_Type_nk == '03', case(length(Exchanged_Type) > 0, 'Sale Exchange', 'Sale'), \r\n     Sale_Type_nk == 'C' && Transaction_Type_nk == '03', case(length(Exchanged_Type) > 0, 'Cancel Exchange', 'Cancel'), \r\n     Sale_Type_nk == 'S' && Transaction_Type_nk == '05', 'Reversal of Sale', \r\n     Sale_Type_nk == 'A' && Transaction_Type_nk == '03', 'Allowance', \r\n     Sale_Type_nk == 'C' && Transaction_Type_nk == '05', 'Reverse Cancel',\r\n     'Unknown Status'),\n\t\tWorksheet = '',\n\t\tDays_to_Deliver = minus(DeliveredDate_trunc, WRITTENDATE_trunc),\n\t\tLP = '',\n\t\tCancel_reason = '',\n\t\t{Gross_Profit_$} = Retail_Sales - Landed_Cost_of_Goods_Sold,\n\t\tOverride_Reason_fk = case(isNull(Override_Reason_fk) && isNull(OVRRSNID), -1, \r\n     isNull(Override_Reason_fk) && (not(isNull(OVRRSNID)) || OVRRSNID == 0), 0,\r\n     Override_Reason_fk),\n\t\tOriginating_DC_fk = 0,\n\t\tDesigner_Team_fk = coalesce(Designer_Team_fk, 0),\n\t\tSales_Team_fk = coalesce(Sales_Team_fk, 0),\n\t\tMerchandising_Promotion_fk = case((isNull(SALEPROMO) || SALEPROMO==''), -1, \r\n     isNull(Merchandising_Promotion_fk) && not(isNull(SALEPROMO)) && SALEPROMO!='' , 0,\r\n     Merchandising_Promotion_fk),\n\t\tCredit_Promotion_fk = case((isNull(CREDITPROMO) || CREDITPROMO==''), -1, \r\n     isNull(Credit_Promotion_fk) && not(isNull(CREDITPROMO)) && CREDITPROMO!='' , 0,\r\n     Credit_Promotion_fk),\n\t\teach(match(right(name,3)=='_fk'&&(name!='Override_Reason_fk')&&name!='Sales_Team_fk'&&name!='Designer_Team_fk'&&name!='Merchandising_Promotion_fk'&&name!='Credit_Promotion_fk'), $$ = coalesce(toInteger($$),0))) ~> DeriveCalculatedColumns\nSelectDimTeamSales, sourceDimDate lookup(WRITTENDATE_trunc == Calendar_date,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimDate\nSelectDimDelieveredDate, sourceDimSKU lookup(ITEM == SKU_Unformatted_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimSKU\nSelectDimSKU, sourceDimSKU lookup(GROUPSKU == SKU_Unformatted_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimSKUGroup\nSelectDimSKUGroup, sourceDimCustomer lookup(CIDNUM == Customer_ID_nk\n\t&& CIDPRFSEQ == Customer_Sequence_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimCustomer\nSelectTbdwemp derive(SALES_NUMBER = toInteger(SALES_NUMBER)) ~> Derivetbdwemp\nSourceTbdwbld derive(TeamMember1_Designer = greatest( coalesce(toInteger(DESIGNER), -1), coalesce(toInteger(CODESIGNER), -1) ),\n\t\tTeamMember2_Designer = least( coalesce(toInteger(DESIGNER), -1), coalesce(toInteger(CODESIGNER), -1) ),\n\t\tTeamType_Designer = 'Designer',\n\t\tGROUPSKU = coalesce(GROUPSKU, ITEM),\n\t\tSALEASC_LookUp = toInteger(DIVISION * 1000000 + MARKET * 1000 + SALEASC),\n\t\tCOSALEASC_LookUp = toInteger(DIVISION * 1000000 + MARKET * 1000 + COSALEASC),\n\t\tWRITTENDATE_trunc = toDate(WRITTENDATE),\n\t\tDeliveredDate_trunc = toDate(BILLEDDATE),\n\t\tPROCESS_NUMBER = toInteger(PROCESS_NUMBER),\n\t\tDIVISION = toInteger(DIVISION),\n\t\tMARKET = toInteger(MARKET),\n\t\tBRANCH = toInteger(BRANCH),\n\t\tSALENUM = toInteger(SALENUM),\n\t\tLINE = toInteger(LINE),\n\t\tTRANSEQUENCE = toInteger(TRANSEQUENCE),\n\t\tORGSALENUM = coalesce(toInteger(ORGSALENUM), 0),\n\t\tCIDNUM = toLong(CIDNUM),\n\t\tCIDPRFSEQ = toInteger(CIDPRFSEQ),\n\t\tSALEASC = toInteger(SALEASC),\n\t\tCOSALEASC = toInteger(COSALEASC),\n\t\tSALEEMPID = toInteger(SALEEMPID),\n\t\tCOSALEEMPID = toInteger(COSALEEMPID),\n\t\tDESIGNER = toInteger(DESIGNER),\n\t\tCODESIGNER = toInteger(CODESIGNER),\n\t\tOVRRSNID = toInteger(OVRRSNID),\n\t\tDELIVERYDC = toInteger(DELIVERYDC),\n\t\tSALEPROMO = upper(trim(SALEPROMO)),\n\t\tCREDITPROMO = upper(trim(CREDITPROMO))) ~> DeriveDesignerTeamLookups\nLookupDimDate select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk = Date_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimDate\nDeriveDesignerTeamLookups, Derivetbdwemp lookup(SALEASC_LookUp == SALES_NUMBER,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupSalesEmpNum\nLookupSalesEmpNum select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date = BILLEDDATE,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance = UNDLVALLOW,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold = LANDEDCOST,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID = EMPLOYEE_NUMBER,\n\t\tBRANCH_emp_Sales = BRANCH_emp\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectSalesEmpNum\nSelectSalesEmpNum, Derivetbdwemp lookup(COSALEASC_LookUp == SALES_NUMBER,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupCoSalesEmpNum\nLookupCoSalesEmpNum select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID = EMPLOYEE_NUMBER,\n\t\tBRANCH_emp_Sales,\n\t\tBRANCH_emp_CoSales = BRANCH_emp\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectCoSalesEmpNum\nSelectCoSalesEmpNum derive(SalesEmpID_Coalesce = case(isNull(SALEEMPID) && isNull(SALEASC_LookUp), -1,\r\n     isNull(SALEEMPID) && not(isNull(SALEASC_LookUp)) && isNull(SalesEmpID), 0,\r\n     coalesce(toInteger(SALEEMPID), toInteger(trim(SalesEmpID)), -1)\r\n),\n\t\tCoSalesEmpID_Coalesce = case(isNull(COSALEEMPID) && isNull(COSALEASC_LookUp), -1,\r\n     isNull(COSALEEMPID) && not(isNull(COSALEASC_LookUp)) && isNull(CoSalesEmpID), 0,\r\n     coalesce(toInteger(COSALEEMPID), toInteger(trim(CoSalesEmpID)), -1)\r\n)) ~> DeriveSalesEmployee\nDeriveSalesEmployee derive(TeamMember1_Sales = greatest(SalesEmpID_Coalesce,CoSalesEmpID_Coalesce),\n\t\tTeamMember2_Sales = least(SalesEmpID_Coalesce,CoSalesEmpID_Coalesce),\n\t\tTeamType_Sales = 'Sales') ~> DeriveSalesTeamLookups\nDeriveSalesTeamLookups derive(each(match(type=='string'), $$ = coalesce(trim($$), ''))) ~> DeriveTrimNullsStrings\nsourceTbdwemp select(mapColumn(\n\t\tEMPLOYEE_NUMBER,\n\t\tSALES_NUMBER,\n\t\tBRANCH_emp = BRANCH\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectTbdwemp\nFilterRowNumber1, sourceDimTeam lookup(TeamMember1_Designer == TeamMember1_ID_nk\n\t&& TeamMember2_Designer == TeamMember2_ID_nk\n\t&& TeamType_Designer == TeamType_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimTeamDesigner\nLookupDimTeamDesigner select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk = Team_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimTeamDesigner\nSelectDimTeamDesigner, sourceDimTeam lookup(TeamMember1_Sales == TeamMember1_ID_nk\n\t&& TeamMember2_Sales == TeamMember2_ID_nk\n\t&& TeamType_Sales == TeamType_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimTeamSales\nLookupDimTeamSales select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk = Team_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimTeamSales\nLookupDimSKU select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk = SKU_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimSKU\nLookupDimSKUGroup select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk = SKU_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimSKUGroup\nLookupDimCustomer select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk = Customer_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimCustomer\nDeriveLocationCode, sourceDimLocation lookup(DeriveLocationCode@Location_Code_nk == sourceDimLocation@Location_Code_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimLocation\nSelectDimCustomer derive(Location_Code_nk = iif(BRANCH < 10,\r\n    iif(MARKET < 10,\r\n    concat(toString(DIVISION), '00', toString(MARKET),'-0', toString(BRANCH)),\r\n        concat(toString(DIVISION), '0', toString(MARKET),'-0', toString(BRANCH))\r\n    ),\r\n        iif(MARKET < 10,\r\n        concat(toString(DIVISION), '00', toString(MARKET),'-', toString(BRANCH)),\r\n        concat(toString(DIVISION), '0', toString(MARKET),'-', toString(BRANCH))\r\n        )\r\n),\n\t\tDelivery_Location_Code_nk = iif(DELIVERYDC < 10,\r\n    iif(MARKET < 10,\r\n    concat(toString(DIVISION), '00', toString(MARKET),'-0', toString(DELIVERYDC)),\r\n        concat(toString(DIVISION), '0', toString(MARKET),'-0', toString(DELIVERYDC))\r\n    ),\r\n        iif(MARKET < 10,\r\n        concat(toString(DIVISION), '00', toString(MARKET),'-', toString(DELIVERYDC)),\r\n        concat(toString(DIVISION), '0', toString(MARKET),'-', toString(DELIVERYDC))\r\n        )\r\n)) ~> DeriveLocationCode\nLookupDimLocation select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tLocation_Code_nk = DeriveLocationCode@Location_Code_nk,\n\t\tDelivery_Location_Code_nk,\n\t\tLocation_fk = Location_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimLocation\nSelectDimDeliveryDC, sourceDimCreditPromotion lookup(CREDITPROMO == Credit_Promotion_Code_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimCreditPromo\nLookupDimCreditPromo select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tLocation_Code_nk,\n\t\tDelivery_Location_Code_nk,\n\t\tLocation_fk,\n\t\tDelivery_DC_fk,\n\t\tCredit_Promotion_fk = Credit_Promotion_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimCreditPromo\nSelectDimCreditPromo, sourceMerchandisingPromotion lookup(SALEPROMO == Merchandising_Promotion_Code_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimMerchandisingPromo\nLookupDimMerchandisingPromo select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tLocation_Code_nk,\n\t\tDelivery_Location_Code_nk,\n\t\tLocation_fk,\n\t\tDelivery_DC_fk,\n\t\tCredit_Promotion_fk,\n\t\tMerchandising_Promotion_fk = Merchandising_Promotion_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimMerchandisingPromo\nSelectDimMerchandisingPromo, sourceDimOverrideReason lookup(OVRRSNID == Override_Reason_ID\n\t&& OVRRSNDESC == Override_Reason\n\t&& OVRRSNCMT == Override_Reason_Text\n\t&& OVRUSRFNAM == Override_Approve_First_Name\n\t&& OVRUSRLNAM == Override_Approve_Last_Name,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimOverrideReason\nLookupDimOverrideReason select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tMarket_nk = MARKET,\n\t\tTransaction_Number_nk = SALENUM,\n\t\tTransaction_Line_Number_nk = LINE,\n\t\tSale_Type_nk = TYPE,\n\t\tTransaction_Type_nk = TRANTYPE,\n\t\tTransaction_Sequence_nk = TRANSEQUENCE,\n\t\tOriginal_Transaction_Number = ORGSALENUM,\n\t\tSales_Units = QUANTITY,\n\t\tGross_Sales = GROSSSLS,\n\t\tGroup_SKU_Discount = GRPSKUDSCT,\n\t\tRetail_Reduction_Discount = RTLREDUCTION,\n\t\tOverride_Discount = OVRDISCOUNT,\n\t\tPromotional_Discount = PROMODISCOUNT,\n\t\tUnclassified_Discount = UNCLASSDSCT,\n\t\tRetail_Sales = RETAIL,\n\t\tTax_Amount_1 = TAXAMT1,\n\t\tTax_Amount_2 = TAXAMT2,\n\t\tCharge_Type = CHARGETYPE,\n\t\tInternet_Sale_Flag = INTERNETSALE,\n\t\tExchanged_Type = EXCHANGETYPE,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tLocation_Code_nk,\n\t\tLocation_fk,\n\t\tCredit_Promotion_fk,\n\t\tMerchandising_Promotion_fk,\n\t\tOverride_Reason_fk = Override_Reason_sk,\n\t\tDelivery_DC_fk,\n\t\tOVRRSNID,\n\t\tDelivered_Date_fk,\n\t\tUndelivered_Allowance,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tOrigination = ORIGINATION,\n\t\tDelivery_Type = DELIVERYTYPE,\n\t\tBuy_Online_Pick_Up_In_Store_Flag = BOLPIS,\n\t\tOmnichannel_Flag = OMNICHANNEL,\n\t\tTransaction_Line_Number_GroupSKU = GROUPLINE,\n\t\tSales_Units_GroupSKU = ITEMSINGROUP,\n\t\tTeamMember1_Sales,\n\t\tTeamMember1_Designer,\n\t\tDeliveredDate_trunc,\n\t\tWRITTENDATE_trunc,\n\t\tCREDITPROMO,\n\t\tSALEPROMO\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimOverrideReasonPlusRenames\nSelectDimLocation, sourceDimLocation lookup(Delivery_Location_Code_nk == sourceDimLocation@Location_Code_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDimDeliveryDC\nLookupDimDeliveryDC select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tLocation_Code_nk = SelectDimLocation@Location_Code_nk,\n\t\tDelivery_Location_Code_nk,\n\t\tLocation_fk,\n\t\tDelivery_DC_fk = Location_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimDeliveryDC\nDeriveCalculatedColumns, sourceFactDeliveredSales lookup(SelectDimOverrideReasonPlusRenames@Transaction_Number_nk == sourceFactDeliveredSales@Transaction_Number_nk\n\t&& SelectDimOverrideReasonPlusRenames@Transaction_Line_Number_nk == sourceFactDeliveredSales@Transaction_Line_Number_nk\n\t&& SelectDimOverrideReasonPlusRenames@Market_nk == sourceFactDeliveredSales@Market_nk\n\t&& SelectDimOverrideReasonPlusRenames@Sale_Type_nk == sourceFactDeliveredSales@Sale_Type_nk\n\t&& SelectDimOverrideReasonPlusRenames@Transaction_Type_nk == sourceFactDeliveredSales@Transaction_Type_nk\n\t&& SelectDimOverrideReasonPlusRenames@Transaction_Sequence_nk == sourceFactDeliveredSales@Transaction_Sequence_nk,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupFactDeliveredSalesExists\nLookupFactDeliveredSalesExists select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tMarket_nk = SelectDimOverrideReasonPlusRenames@Market_nk,\n\t\tTransaction_Number_nk = SelectDimOverrideReasonPlusRenames@Transaction_Number_nk,\n\t\tTransaction_Line_Number_nk = SelectDimOverrideReasonPlusRenames@Transaction_Line_Number_nk,\n\t\tSale_Type_nk = SelectDimOverrideReasonPlusRenames@Sale_Type_nk,\n\t\tTransaction_Type_nk = SelectDimOverrideReasonPlusRenames@Transaction_Type_nk,\n\t\tTransaction_Sequence_nk = SelectDimOverrideReasonPlusRenames@Transaction_Sequence_nk,\n\t\tOriginal_Transaction_Number,\n\t\tSales_Units,\n\t\tGross_Sales,\n\t\tGroup_SKU_Discount,\n\t\tRetail_Reduction_Discount,\n\t\tOverride_Discount,\n\t\tPromotional_Discount,\n\t\tUnclassified_Discount,\n\t\tRetail_Sales,\n\t\tTax_Amount_1,\n\t\tTax_Amount_2,\n\t\tCharge_Type,\n\t\tInternet_Sale_Flag,\n\t\tExchanged_Type,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tLocation_Code_nk,\n\t\tLocation_fk,\n\t\tCredit_Promotion_fk,\n\t\tMerchandising_Promotion_fk,\n\t\tOverride_Reason_fk,\n\t\tDelivery_DC_fk,\n\t\tOVRRSNID,\n\t\tDelivered_Date_fk,\n\t\tUndelivered_Allowance,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tOrigination,\n\t\tDelivery_Type,\n\t\tBuy_Online_Pick_Up_In_Store_Flag,\n\t\tOmnichannel_Flag,\n\t\tTransaction_Line_Number_GroupSKU,\n\t\tSales_Units_GroupSKU,\n\t\tSourceSystem_fk,\n\t\tETLBatchID_Update,\n\t\tTotal_Discount,\n\t\tSales_Status,\n\t\tWorksheet,\n\t\tDays_to_Deliver,\n\t\tLP,\n\t\tCancel_reason,\n\t\t{Gross_Profit_$},\n\t\tOriginating_DC_fk,\n\t\tDelivered_Sales_sk_Dest = Delivered_Sales_sk,\n\t\tETLBatchID_Insert_Dest = ETLBatchID_Insert\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectFactDeliveredSalesExists\nFilterDuplicates filter(isNull(Delivered_Sales_sk_Dest)||\r\n(!isNull(Delivered_Sales_sk_Dest) && \r\n    Written_Date_fk > toInteger($ControlEndDate) || Written_Date_fk < toInteger($ControlStartDate))) ~> FilterNewAndUpdates\nSelectFactDeliveredSalesExists derive(ETLBatchID_Insert = coalesce(ETLBatchID_Insert_Dest, PROCESS_NUMBER)) ~> DeriveETLBatchIDInsert\nSelectDimDate, sourceDimDate lookup(DeliveredDate_trunc == Calendar_date,\n\tmultiple: true,\n\tbroadcast: 'none')~> LookupDeliveredDate\nLookupDeliveredDate select(mapColumn(\n\t\tPROCESS_NUMBER,\n\t\tDIVISION,\n\t\tMARKET,\n\t\tBRANCH,\n\t\tSALENUM,\n\t\tLINE,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE,\n\t\tORGSALENUM,\n\t\tDelivered_Date,\n\t\tWRITTENDATE,\n\t\tITEM,\n\t\tGROUPSKU,\n\t\tQUANTITY,\n\t\tGROSSSLS,\n\t\tGRPSKUDSCT,\n\t\tRTLREDUCTION,\n\t\tOVRDISCOUNT,\n\t\tPROMODISCOUNT,\n\t\tUNCLASSDSCT,\n\t\tUndelivered_Allowance,\n\t\tRETAIL,\n\t\tTAXAMT1,\n\t\tTAXAMT2,\n\t\tCIDNUM,\n\t\tCIDPRFSEQ,\n\t\tSALEASC,\n\t\tSALEEMPID,\n\t\tCOSALEASC,\n\t\tCOSALEEMPID,\n\t\tDESIGNER,\n\t\tCODESIGNER,\n\t\tOVRRSNID,\n\t\tOVRRSNDESC,\n\t\tOVRRSNCMT,\n\t\tOVRUSRFNAM,\n\t\tOVRUSRLNAM,\n\t\tSALEPROMO,\n\t\tCREDITPROMO,\n\t\tDELIVERYDC,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\tCHARGETYPE,\n\t\tINTERNETSALE,\n\t\tEXCHANGETYPE,\n\t\tGROUPLINE,\n\t\tITEMSINGROUP,\n\t\tOMNICHANNEL,\n\t\tDELIVERYTYPE,\n\t\tORIGINATION,\n\t\tBOLPIS,\n\t\tTeamMember1_Designer,\n\t\tTeamMember2_Designer,\n\t\tTeamType_Designer,\n\t\tSALEASC_LookUp,\n\t\tCOSALEASC_LookUp,\n\t\tWRITTENDATE_trunc,\n\t\tDeliveredDate_trunc,\n\t\tSalesEmpID,\n\t\tCoSalesEmpID,\n\t\tSalesEmpID_Coalesce,\n\t\tCoSalesEmpID_Coalesce,\n\t\tTeamMember1_Sales,\n\t\tTeamMember2_Sales,\n\t\tTeamType_Sales,\n\t\tDesigner_Team_fk,\n\t\tSales_Team_fk,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk = Date_sk\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimDelieveredDate\nDeriveETLBatchIDInsert window(over(Transaction_Number_nk,\n\t\tTransaction_Line_Number_nk,\n\t\tMarket_nk,\n\t\tSale_Type_nk,\n\t\tTransaction_Type_nk,\n\t\tTransaction_Sequence_nk),\n\tasc(Transaction_Number_nk, true),\n\tasc(Transaction_Line_Number_nk, true),\n\tasc(Market_nk, true),\n\tasc(Sale_Type_nk, true),\n\tasc(Transaction_Type_nk, true),\n\tasc(Transaction_Sequence_nk, true),\n\tRowNumer2 = rowNumber()) ~> WindowRowNumber\nWindowRowNumber filter(RowNumer2==1) ~> FilterDuplicates\nDeriveTrimNullsStrings window(over(SALENUM,\n\t\tLINE,\n\t\tMARKET,\n\t\tTYPE,\n\t\tTRANTYPE,\n\t\tTRANSEQUENCE),\n\tasc(BRANCH, false),\n\tasc(BRANCH_emp_Sales, false),\n\tasc(BRANCH_emp_CoSales, false),\n\tdesc(toInteger(trim(SalesEmpID)), false),\n\tdesc(toInteger(trim(CoSalesEmpID)), false),\n\tRowNumber1 = rowNumber()) ~> WindowRowNumber1\nWindowRowNumber1 filter(RowNumber1==1) ~> FilterRowNumber1\nAlwaysInsertDeleteInSinkPreSQL sink(input(\n\t\tDelivered_Sales_sk as integer,\n\t\tGross_Sales as decimal(7,2),\n\t\tGroup_SKU_Discount as decimal(7,2),\n\t\tRetail_Reduction_Discount as decimal(7,2),\n\t\tOverride_Discount as decimal(7,2),\n\t\tPromotional_Discount as decimal(7,2),\n\t\tUnclassified_Discount as decimal(7,2),\n\t\tUndelivered_Allowance as decimal(7,2),\n\t\tTotal_Discount as decimal(7,2),\n\t\tRetail_Sales as decimal(9,2),\n\t\tTax_Amount_1 as decimal(7,2),\n\t\tTax_Amount_2 as decimal(7,2),\n\t\tSales_Units as integer,\n\t\tSales_Units_GroupSKU as integer,\n\t\tLanded_Cost_of_Goods_Sold as decimal(9,2),\n\t\t{Gross_Profit_$} as decimal(9,2),\n\t\tDays_to_Deliver as integer,\n\t\tWritten_Date_fk as integer,\n\t\tDelivered_Date_fk as integer,\n\t\tLocation_fk as integer,\n\t\tDelivery_DC_fk as integer,\n\t\tOriginating_DC_fk as integer,\n\t\tSKU_fk as integer,\n\t\tSKU_Group_fk as integer,\n\t\tCustomer_fk as integer,\n\t\tSales_Team_fk as integer,\n\t\tDesigner_Team_fk as integer,\n\t\tMerchandising_Promotion_fk as integer,\n\t\tCredit_Promotion_fk as integer,\n\t\tOverride_Reason_fk as integer,\n\t\tTransaction_Number_nk as integer,\n\t\tTransaction_Line_Number_nk as integer,\n\t\tTransaction_Line_Number_GroupSKU as integer,\n\t\tMarket_nk as integer,\n\t\tSales_Status as string,\n\t\tOriginal_Transaction_Number as integer,\n\t\tSale_Type_nk as string,\n\t\tTransaction_Type_nk as string,\n\t\tTransaction_Sequence_nk as integer,\n\t\tCharge_Type as string,\n\t\tExchanged_Type as string,\n\t\tWorksheet as string,\n\t\tInternet_Sale_Flag as string,\n\t\tLP as string,\n\t\tCancel_reason as string,\n\t\tDelivery_Type as string,\n\t\tOmnichannel_Flag as string,\n\t\tOrigination as string,\n\t\tBuy_Online_Pick_Up_In_Store_Flag as string,\n\t\tSourceSystem_fk as integer,\n\t\tETLBatchID_Insert as integer,\n\t\tETLBatchID_Update as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['Transaction_Number_nk','Transaction_Line_Number_nk','Market_nk','Sale_Type_nk','Transaction_Type_nk','Transaction_Sequence_nk'],\n\tformat: 'table',\n\tmapColumn(\n\t\tGross_Sales,\n\t\tGroup_SKU_Discount,\n\t\tRetail_Reduction_Discount,\n\t\tOverride_Discount,\n\t\tPromotional_Discount,\n\t\tUnclassified_Discount,\n\t\tUndelivered_Allowance,\n\t\tTotal_Discount,\n\t\tRetail_Sales,\n\t\tTax_Amount_1,\n\t\tTax_Amount_2,\n\t\tSales_Units,\n\t\tSales_Units_GroupSKU,\n\t\tLanded_Cost_of_Goods_Sold,\n\t\t{Gross_Profit_$},\n\t\tDays_to_Deliver,\n\t\tWritten_Date_fk,\n\t\tDelivered_Date_fk,\n\t\tLocation_fk,\n\t\tDelivery_DC_fk,\n\t\tOriginating_DC_fk,\n\t\tSKU_fk,\n\t\tSKU_Group_fk,\n\t\tCustomer_fk,\n\t\tSales_Team_fk,\n\t\tDesigner_Team_fk,\n\t\tMerchandising_Promotion_fk,\n\t\tCredit_Promotion_fk,\n\t\tOverride_Reason_fk,\n\t\tTransaction_Number_nk,\n\t\tTransaction_Line_Number_nk,\n\t\tTransaction_Line_Number_GroupSKU,\n\t\tMarket_nk,\n\t\tSales_Status,\n\t\tOriginal_Transaction_Number,\n\t\tSale_Type_nk,\n\t\tTransaction_Type_nk,\n\t\tTransaction_Sequence_nk,\n\t\tCharge_Type,\n\t\tExchanged_Type,\n\t\tWorksheet,\n\t\tInternet_Sale_Flag,\n\t\tLP,\n\t\tCancel_reason,\n\t\tDelivery_Type,\n\t\tOmnichannel_Flag,\n\t\tOrigination,\n\t\tBuy_Online_Pick_Up_In_Store_Flag,\n\t\tSourceSystem_fk,\n\t\tETLBatchID_Insert,\n\t\tETLBatchID_Update\n\t)) ~> sinkFactDeliveredSales"
		}
	}
}